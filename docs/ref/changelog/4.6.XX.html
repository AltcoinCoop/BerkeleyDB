<!--$Id: 4.6.XX.html,v 1.14 2007/01/29 22:27:15 bostic Exp $-->
<html>
<head>
<title>The Berkeley DB Package: DB 4.6.XX Change Log</title>
<meta name="description" content="Berkeley DB: A database programmatic toolkit."> 
<meta name="keywords" content="embedded,database,programmatic,toolkit,b+tree,btree,hash,hashing,transaction,transactions,locking,logging,access method,access methods"> 
</head>
<body bgcolor=white>

<h3 align=center>Berkeley DB 4.6.XX Change Log</h3>
<h3>Database or Log File On-Disk Format Changes:</h3>

None.

<h3>New Features:</h3>
<ol>

<li>Add support for a cursor DB_PREV_DUP flag, which moves the cursor
to the previous key/data pair if it's a duplicate of the current
key/data pair. [#4801]
<li>Add verbose output tracing for filesystem operations. [#13760]
<li>Port Berkeley DB to Qualcomm's Binary Runtime Environment for
Wireless (BREW). [#14562]

</ol>
<h3>Database Environment Changes:</h3>
<ol>

<li>Add support to close open file handles in the case of catastrophic
database environment failure so applications that do not exit and
restart on failure won't leak file handles. [#6538]
<li>Replace the Berkeley DB shared memory allocator with a new
implementation, intended to decrease the performance drop-off seen in
database environments having working sets that are larger than the
cache, especially database environments with multiple cache page sizes.
[#13122]
<li>Fix a bug that would incorrectly cause a thread to appear to be
in the Berkeley DB API after a call to db_create. [#14562]
<li>Fix a bug where the db_stat utility -Z flag and the statistics
method's DB_STAT_CLEAR flag could clear mutex statistics too quickly,
leading to incorrect values being displayed. [#15032]
<li>Fix a bug where removal of a file after and open/close pair spanning
the most recent checkpoint log-sequence-numbers made recovery fail.
[#15092]
<li>Fix a bug that could leave an environment unrecoverable if FTRUNCATE
was not set and a roll-forward to a timestamp was interrupted between the
truncation of the log and the recording of aborted allocations. [#15108]
<li> Fix a bug where recovery of a rename operation could fail if the
rename occurred in a directory that no longer existed. [#15119]
<li>Fix a bug that could cause recovery to report a "File exists"
error if a committed create was partially recovered by a previously
failed recovery operation. [#15151]
<li>Fix a bug where the DbEnv.get_thread_count method implementation was
missing from the Berkeley DB 4.5 release. [#15201]
<li>Fix a bug where replication operations were not reported properly
when the DbEnv.failchk method was called. [#15094]
<li> Fixed a bug that caused SEQ-&gt;remove not to use a transaction
if the sequence was opened on a transactional database handle but no
transaction was specified on the call. [#15235]
<li>Fix a bug where accesses to the database environment reference count
could race, causing the DB_ENV-&gt;remove method to incorrectly remove
or not remove a database environment. [#15240]
<li>Fix a bug that could cause a recovery failure if a partial record
was written near the end of a log file before a crash and then never
overwritten after recovery runs and before a log file switch occurs.
[#15302]
<li>Fix a bug that could fire a diagnostic assertion if an error occurred
during a database environment open. [#15309]

</ol>
<h3>Concurrent Data Store Changes:</h3>

None.

<h3>General Access Method Changes:</h3>
<ol>

<li>Open, create, close and removal of non-transactional databases is
are longer logged in transactional database environments unless debug
logging is enabled. [#8037]
<li>Add the ability to set cache page priority on a database or cursor
handle. [#11886]
<li>fix a bug where the DB_ENV-&gt;fileid_reset method failed when
called on on encrypted or check-summed databases. [#13990]
<li>Fix a bug where the DB-&gt;fd method failed when called on
in-memory databases. [#14157]
<li>Fix a bug where transactional file operations, such as remove or
rename, could leak file handles. [#15222]
<li>Fix a bug that could cause the in-memory sorted freelist used by the
DB-&gt;compact method not to be freed if transaction or lock timeouts
were set in the environment. [#15292]

</ol>
<h3>Btree Access Method Changes:</h3>

None.

<h3>Hash Access Method Changes:</h3>

None.

<h3>Queue Access Method Changes:</h3>

None.

<h3>Recno Access Method Changes:</h3>

None.

<h3>C++-specific API Changes:</h3>

None.

<h3>Java-specific API Changes:</h3>
<ol>

<li>Add a feature where an exception is thrown by the Java API, the
Berkeley DB error message is now included in the exception object.
[#11870]
<li>Fix a bug which can cause a JVM crash when doing a partial get
operation. [#15143]
<li>Fix a bug where DBTs were not being copied correctly in the base
replication Java API. [#15223]

</ol>
<h3>Java collections and bind API Changes:</h3>

None.

<h3>Tcl-specific API Changes:</h3>

None.

<h3>RPC-specific Client/Server Changes:</h3>

None.

<h3>Replication Changes:</h3>
<ol>

<li>Fix a bug where transactions could be rolled-back if an existing
replication group master was partitioned and unable to participate in
an election. [#14752]
<li>Add a new event when a replication manager framework master fails
to send and confirm receipt by clients of a "permanent" message.
[#14775]
<li>Fix a race where multiple threads might attempt to process a
LOGREADY condition. [#14902]
<li>Change the DB_VERB_REPLICATION flag to no longer require the
Berkeley DB library be built with the --enable-diagnostic configuration
option to output additional replication logging information. [#14991]
<li>Fix a bug with elections occurring during internal init of a
replication client site. [#15057]
<li>Fix lockout code to lockout message threads and API separately.
Send indication that log requests is for internal init. [#15067]
<li>Replication manager changed to retry host-name look-up failures,
since they could be caused by transient name server outage.
[#15081]
<li>Fix a bug which led to memory corruption when the sending of a bulk
buffer resulted in an error. [#15100]
<li>A throttling limit of 10 megabytes is now set by default in a newly
created database environment (see the DbEnv.rep_set_limit method).
[#15115]
<li>Fix a bug in ALL_REQ handling where master could get a DB_NOTFOUND.
[#15116]
<li>Fix a bug which could lead to client sites repeatedly but unproductively
calling for an election, when a master site already exists. [#15128]
<li>Modify gap processing algorithms so XXX_MORE messages ask for data
beyond what it just processed, not an earlier gap that might exist.
[#15136]
<li>Fixed a bug in the ex_rep example application which could cause the
last few transactions to disappear when shutting down the sites of the
replication group gracefully. [#15162]
<li>Fix a bug where election flags are not cleared atomically with the
setting of the new master ID. [#15186]
<li>Fix minor memory leaks in the replication manager. [#15239] [#15256]

</ol>
<h3>XA Resource Manager Changes:</h3>

None.

<h3>Locking Subsystem Changes:</h3>
<ol>

<li>Change the DB_ENV-&gt;lock_detect method to return the number of
transactions timed out in addition to those were rejected due to
deadlock. [#15281]

</ol>
<h3>Logging Subsystem Changes:</h3>

None.

<h3>Memory Pool Subsystem Changes:</h3>
<ol>

<li>Fix a bug that could cause a checkpoint to hang if a database was
closed while the checkpoint was forcing that file to disk and all the
pages for that database were replaced in the cache. [#15135]
<li>Fix a bug where a system error in closing a file could result in a
core dump. [#15137]
<li>Fix MVCC statistics counts for private database environments. [#15218]

</ol>
<h3>Transaction Subsystem Changes:</h3>

None.

<h3>Utility Changes:</h3>
<ol>

<li>Fix a bug that prevented db_load from handling subdatabase names
that were of zero length. [#8204]

</ol>
<h3>Configuration, Documentation, Portability and Build Changes:</h3>
<ol>

<li>Berkeley DB no longer supports process-shared database environments
on Windows 9X platforms; the DB_PRIVATE flag must always be specified
to the DB_ENV-&gt;open method. [#13766]
<li>Port Berkeley DB to Qualcomm's Binary Runtime Environment for
Wireless (BREW). [#14562]
<li>Changed include files so ENOENT is resolved on Windows. [#15078]

</ol>
</body>
</html>
